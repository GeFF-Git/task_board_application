# Implement Database Logging with Serilog

This plan outlines the steps to add centralized database logging throughout the `TaskBoard.API` application using Serilog and its MS SQL Server sink.

## Proposed Changes

### TaskBoard.API
Changes to the main API project to integrate Serilog.

#### [MODIFY] [TaskBoard.API.csproj](file:///c:/Users/ETR%20Infotech/Desktop/task_board/task-board-api/TaskBoard.API/TaskBoard.API.csproj)
- Add `Serilog.AspNetCore` NuGet package reference.
- Add `Serilog.Sinks.MSSqlServer` NuGet package reference.

#### [MODIFY] [appsettings.json](file:///c:/Users/ETR%20Infotech/Desktop/task_board/task-board-api/TaskBoard.API/appsettings.json)
- Add `Serilog` configuration section.
- Configure the `MSSqlServer` sink to use the `DefaultConnection`.
- Set the sink to log to a table named `AppLogs` and enable the `autoCreateSqlTable` option so the table is generated automatically on startup.
- Remove the default [Logging](file:///c:/Users/ETR%20Infotech/Desktop/task_board/task-board-api/TaskBoard.API/Middleware/RequestLoggingMiddleware.cs#3-36) section as it will be overridden by Serilog.

#### [MODIFY] [Program.cs](file:///c:/Users/ETR%20Infotech/Desktop/task_board/task-board-api/TaskBoard.API/Program.cs)
- Add `using Serilog;`.
- Configure `Log.Logger` at the very start of the application.
- Add `builder.Host.UseSerilog()` to replace the default ASP.NET Core logging provider with Serilog.
- Ensure `Log.CloseAndFlush()` is called on application exit using a try/finally block.

## Verification Plan

### Automated Tests
- Run existing unit tests using `dotnet test` in the `TaskBoard.Tests` directory to ensure no regressions were introduced.

### Manual Verification
- Start the API using `dotnet run` in the `TaskBoard.API` directory.
- Send a request to an endpoint (e.g., via the Swagger UI or `Invoke-RestMethod`).
- Use `sqlcmd` or a PowerShell script to query the local database (`TaskBoardDb`) and verify that new entries appear in the `AppLogs` table.
